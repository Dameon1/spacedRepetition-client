(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{132:function(e,t,n){e.exports=n(258)},140:function(e,t,n){},144:function(e,t,n){},146:function(e,t,n){},148:function(e,t,n){},247:function(e,t,n){},250:function(e,t,n){},252:function(e,t,n){},254:function(e,t,n){},256:function(e,t,n){},258:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(101),c=n.n(o),u=n(261),i=n(8),s=n(11),l=n(12),p=n(14),h=n(13),m=n(15),d=(n(140),function(){return a.a.createElement("div",{className:"header-bar"},a.a.createElement("h1",null,"SPANISH FLASH"))}),f=n(103),E=n.n(f),b=n(72),g=[null,null],O=(g="https://spaced-rep.herokuapp.com/api,/spacedRepetition-client".split(","))[0]||"http://localhost:8080/api",S=g[1]||"localhost:3000",v=function(e){return e.ok?e:e.headers.has("content-type")&&e.headers.get("content-type").startsWith("application/json")?e.json().then(function(e){return Promise.reject(e)}):Promise.reject({code:e.status,message:e.statusText})},y=function(){try{localStorage.removeItem("authToken")}catch(e){}},j="SET_AUTH_TOKEN",N=function(e){return{type:j,authToken:e}},R="CLEAR_AUTH",T=function(){return{type:R}},U="AUTH_REQUEST",_=function(){return{type:U}},I="AUTH_SUCCESS",C="AUTH_ERROR",w=function(e){return{type:C,error:e}},k=function(e,t){var n,r=E()(e);t(N(e)),t((n=r.user,{type:I,currentUser:n})),function(e){try{localStorage.setItem("authToken",e)}catch(t){}}(e)},q=function(e,t){return function(n){return n(_()),fetch("".concat(O,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}).then(function(e){return v(e)}).then(function(e){return e.json()}).then(function(e){var t=e.authToken;return k(t,n)}).catch(function(e){var t=401===e.code?"Incorrect username or password":"Unable to login, please try again";return n(w(e)),Promise.reject(new b.a({_error:t}))})}},P=function(){return function(e,t){e(_());var n=t().auth.authToken;return fetch("".concat(O,"/auth/refresh"),{method:"POST",headers:{Authorization:"Bearer ".concat(n)}}).then(function(e){return v(e)}).then(function(e){return e.json()}).then(function(t){var n=t.authToken;return k(n,e)}).catch(function(t){e(w(t)),e(T()),y()})}},A=function(){return function(e,t){return e({type:"GET_QUESTION_REQUEST"}),fetch("".concat(O,"/question"),{headers:{authorization:"Bearer ".concat(t().auth.authToken)}}).then(function(e){return v(e)}).then(function(e){return e.json()}).then(function(t){var n=t.question,r=t.right,a=t.wrong,o=Math.floor(r/(r+a)*100);e(function(e,t){return{type:"GET_QUESTION_SUCCESS",question:e,accuracy:t}}(n,o))}).catch(function(t){e({type:"GET_QUESTION_ERROR",error:t})})}},D=function(e){return function(t,n){return t({type:"SEND_USER_RESPONSE_REQUEST"}),fetch("".concat(O,"/question"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n().auth.authToken)},body:JSON.stringify({userResponse:e})}).then(function(e){return v(e)}).then(function(e){return t({type:"SEND_USER_RESPONSE_SUCCESS"}),204===e.status?Promise.resolve("Correct"):e.json()}).catch(function(e){return t({type:"SEND_USER_RESPONSE_ERROR",error:e})})}},x=(n(144),Object(i.b)(function(e){return{loggedIn:null!==e.auth.currentUser,user:e.auth.currentUser,accuracy:e.question.accuracy}},function(e){return{logOut:function(){e(T()),e({type:"CLEAR_QUESTION"}),y()}}})(function(e){var t,n,r,o;return e.loggedIn&&(t=a.a.createElement("button",{onClick:function(){return e.logOut()},className:"log-out"},"Log out"),n=a.a.createElement("strong",null,e.user.username)),e.accuracy&&(o=a.a.createElement("strong",{className:"accuracy"},"ACCURACY: ",e.accuracy,"%")),r=e.Child,a.a.createElement("div",{className:"card"},o,a.a.createElement(r,null),a.a.createElement("div",null,n,t))})),Q=(n(146),function(e){function t(){return Object(s.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){!e.meta.active&&this.props.meta.active&&this.input.focus()}},{key:"render",value:function(){var e,t,n=this;return this.props.meta.touched&&this.props.meta.error&&(e=a.a.createElement("div",{className:"form-error"},this.props.meta.error)),this.props.meta.touched&&this.props.meta.warning&&(t=a.a.createElement("div",{className:"form-warning"},this.props.meta.warning)),a.a.createElement("div",{className:"form-input"},a.a.createElement("label",{htmlFor:this.props.input.name},this.props.label,e,t),a.a.createElement("input",Object.assign({autoComplete:this.props.autocomplete},this.props.input,{id:this.props.input.name,type:this.props.type,ref:function(e){return n.input=e}})))}}]),t}(a.a.Component)),L=function(e){return e?void 0:"Required"},M=function(e){return""!==e.trim()?void 0:"Cannot be empty"},G=function(e){return e.trim()===e?void 0:"Cannot start or end with whitespace"},H=n(98),F=n(99),J=n(26),B=(n(148),function(e){function t(){return Object(s.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"onSubmit",value:function(e){return this.props.dispatch(q(e.username,e.password))}},{key:"render",value:function(){var e,t=this;return this.props.error&&(e=a.a.createElement("div",{className:"form-error","aria-live":"polite"},this.props.error)),a.a.createElement("form",{className:"login-form",onSubmit:this.props.handleSubmit(function(e){return t.onSubmit(e)})},e,a.a.createElement(H.a,{component:Q,type:"text",name:"username",id:"username",label:"USERNAME",autocomplete:"username",validate:[L,M]}),a.a.createElement(H.a,{component:Q,type:"password",name:"password",id:"password",label:"PASSWORD",autocomplete:"current-password",validate:[L,M]}),a.a.createElement("button",{disabled:this.props.pristine||this.props.submitting},"LOGIN"))}}]),t}(a.a.Component)),W=Object(F.a)({form:"login",onSubmitFail:function(e,t){return t(Object(J.a)("login","username"))}})(B),z=n(259),V=n(263);n(247);var X,K,Y=Object(V.a)(Object(i.b)(function(e){return{loggedIn:null!==e.auth.currentUser}})(function(e){return e.loggedIn&&e.dispatch(A()).then(function(){return e.history.push("".concat(S,"/dashboard"))}),a.a.createElement("div",{className:"landing-page"},a.a.createElement(x,{Child:W}),a.a.createElement(z.a,{to:"".concat(S,"/register")},"Don't have an account? Register here!"))})),Z=n(106),$=n(262),ee=(n(250),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(p.a)(this,Object(h.a)(t).call(this,e))).submit=function(e){e.preventDefault(),""!==n.state.userInput.trim()&&n.props.dispatch(D(n.state.userInput.trim())).then(function(e){n.setState({userInput:"",answer:e})})},n.nextQuestion=function(e){e.preventDefault(),n.setState({answer:null},function(){return n.props.dispatch(A())})},n.state={userInput:"",answer:null},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return this.props.error&&this.props.error.message?(console.log(this.props.error),a.a.createElement("p",null,this.props.error.message)):this.props.question||this.state.answer?this.state.answer?a.a.createElement("div",{className:"question-answer"},a.a.createElement("h2",null,this.state.answer),a.a.createElement("form",{onSubmit:function(t){e.nextQuestion(t)}},a.a.createElement("button",{type:"submit"},"Next Question"))):a.a.createElement("div",{className:"question"},a.a.createElement("h2",{className:"question-text"},this.props.question),a.a.createElement("form",{className:"question-user-response",onSubmit:function(t){return e.submit(t)}},a.a.createElement("input",{"aria-label":"response",type:"text",value:this.state.userInput,onChange:function(t){return e.setState({userInput:t.target.value})}}),a.a.createElement("button",{type:"submit"},"Check"))):a.a.createElement("div",null)}}]),t}(a.a.Component)),te=Object(i.b)(function(e){return{question:e.question.question,error:e.question.error}})(ee),ne=function(e){function t(){return Object(s.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.question||this.props.dispatch(A())}},{key:"render",value:function(){return a.a.createElement("div",{className:"dashboard"},a.a.createElement("div",{className:"dashboard-username"},a.a.createElement(x,{Child:te})))}}]),t}(a.a.Component),re=function(e){function t(t){var n=t.authenticating,r=t.loggedIn,o=t.error,c=Object(Z.a)(t,["authenticating","loggedIn","error"]);return n?a.a.createElement("div",null,"Logging in..."):!r||o?a.a.createElement($.a,{to:"".concat(S,"/")}):a.a.createElement(e,c)}var n=e.displayName||e.name||"Component";return t.displayName="RequiresLogin(".concat(n,")"),Object(i.b)(function(e,t){return{authenticating:e.auth.loading,loggedIn:null!==e.auth.currentUser,error:e.auth.error}})(t)}(Object(i.b)(function(e){return{question:e.question.question}})(ne)),ae=n(54),oe=(X={min:6,max:72},function(e){return X.min&&e.length<X.min?"Must be at least ".concat(X.min," characters long"):X.max&&e.length>X.max?"Must be at most ".concat(X.max," characters long"):void 0}),ce=(K="password",function(e,t){return K in t&&e.trim()===t[K].trim()?void 0:"Does not match"}),ue=function(e){function t(){return Object(s.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"onSubmit",value:function(e){var t=this,n=e.username,r=e.password,a={username:n,password:r};return this.props.dispatch(function(e){return function(t){return fetch("".concat(O,"/users"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then(function(e){return v(e)}).then(function(e){return e.json()}).catch(function(e){var t=e.reason,n=e.message,r=e.location;if("ValidationError"===t)return Promise.reject(new b.a(Object(ae.a)({},r,n)))})}}(a)).then(function(){return t.props.dispatch(q(n,r))})}},{key:"render",value:function(){var e=this;return a.a.createElement("form",{className:"login-form",onSubmit:this.props.handleSubmit(function(t){return e.onSubmit(t)})},a.a.createElement(H.a,{component:Q,type:"text",name:"username",label:"USERNAME",validate:[L,M,G]}),a.a.createElement(H.a,{component:Q,type:"password",name:"password",label:"PASSWORD",validate:[L,oe,G]}),a.a.createElement(H.a,{component:Q,type:"password",name:"passwordConfirm",label:"CONFIRM",validate:[L,M,ce]}),a.a.createElement("button",{type:"submit",disabled:this.props.pristine||this.props.submitting},"Register"))}}]),t}(a.a.Component),ie=Object(F.a)({form:"registration",onSubmitFail:function(e,t){return t(Object(J.a)("registration",Object.keys(e)[0]))}})(ue);n(252);var se=Object(i.b)(function(e){return{loggedIn:null!==e.auth.currentUser}})(function(e){return e.loggedIn?a.a.createElement($.a,{to:"".concat(S,"/dashboard")}):a.a.createElement("div",{className:"registration-page"},a.a.createElement(x,{Child:ie}),a.a.createElement(z.a,{to:"".concat(S,"/")},"Already have an account? Login here!"))}),le=n(260),pe=(n(254),function(e){function t(){return Object(s.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){!e.loggedIn&&this.props.loggedIn?this.startPeriodicRefresh():e.loggedIn&&!this.props.loggedIn&&this.stopPeriodicRefresh()}},{key:"componentWillUnmount",value:function(){this.stopPeriodicRefresh()}},{key:"startPeriodicRefresh",value:function(){var e=this;this.refreshInterval=setInterval(function(){return e.props.dispatch(P())},36e5)}},{key:"stopPeriodicRefresh",value:function(){this.refreshInterval&&clearInterval(this.refreshInterval)}},{key:"render",value:function(){return a.a.createElement("main",{className:"app"},a.a.createElement(d,null),a.a.createElement(le.a,{exact:!0,path:"".concat(S,"/"),component:Y}),a.a.createElement(le.a,{exact:!0,path:"".concat(S,"/dashboard"),component:re}),a.a.createElement(le.a,{exact:!0,path:"".concat(S,"/register"),component:se}))}}]),t}(a.a.Component)),he=Object(V.a)(Object(i.b)(function(e){return{hasAuthToken:null!==e.auth.authToken,loggedIn:null!==e.auth.currentUser}})(pe)),me=n(7),de=n(100),fe=n(105),Ee={authToken:null,currentUser:null,loading:!1,error:null};var be=n(27),ge={question:null,accuracy:null,loading:!1,error:null},Oe=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||me.d,Se=Object(me.e)(Object(me.c)({form:de.a,auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,t=arguments.length>1?arguments[1]:void 0;return t.type===j?Object.assign({},e,{authToken:t.authToken}):t.type===R?Object.assign({},e,{authToken:null,currentUser:null}):t.type===U?Object.assign({},e,{loading:!0,error:null}):t.type===I?Object.assign({},e,{loading:!1,currentUser:t.currentUser}):t.type===C?Object.assign({},e,{loading:!1,error:t.error}):e},question:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_QUESTION_REQUEST":return Object(be.a)({},e,{loading:!0,error:null});case"GET_QUESTION_SUCCESS":return Object(be.a)({},e,{loading:!1,question:t.question,accuracy:t.accuracy});case"GET_QUESTION_ERROR":return Object(be.a)({},e,{loading:!1,error:t.error});case"SEND_USER_RESPONSE_REQUEST":return Object(be.a)({},e,{loading:!0,error:null});case"SEND_USER_RESPONSE_SUCCESS":return Object(be.a)({},e,{loading:!1,question:null});case"SEND_USER_RESPONSE_ERROR":return Object(be.a)({},e,{loading:!1,error:t.error});case"CLEAR_QUESTION":return ge;default:return e}}}),Oe(Object(me.a)(fe.a))),ve=localStorage.getItem("authToken");if(ve){var ye=ve;Se.dispatch(N(ye)),Se.dispatch(P())}var je=Se;n(256);c.a.render(a.a.createElement(i.a,{store:je},a.a.createElement(u.a,null,a.a.createElement(he,null))),document.getElementById("root"))}},[[132,2,1]]]);
//# sourceMappingURL=main.1a68d392.chunk.js.map